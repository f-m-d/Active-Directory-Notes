<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Security Descriptors</title>
</head><body><b><div style="text-align: center"><span style="font-size: 31pt">Security Descriptors</span></div></b><br/>
<br/>
E' possibile modificare i Security Descriptors<br/>
(informazioni di sicurezza come Owner, Primary Group, DACL e SACL)<br/>
di metodi ad <b>accesso multiplo remoto (securable objects)<br/>
</b>per permettere l'accesso ad utenti non-admin.<br/>
<br/>
Sono necessari privilegi da <b>Administrator</b>&nbsp;per fare ci√≤.<br/>
<br/>
Questo permette di creare una backdoor molto utile sul sistema.<br/>
<br/>
<hr/><hr/><br/>
<b>Security Descriptor Definition Language</b><br/>
<br/>
<br/>
Il <b>Security Descriptor Definition Language (SDDL)<br/>
</b>permette di descrivere il formato dove<br/>
viene scritto un Security Descriptor.<br/>
<br/>
SDDL utilizza stringhe <b>ACE</b>&nbsp;per DACL e SACL:<br/>
<b><i>ace_type; ace_flags; rights; object_guid; inherit_object_guid; account_sid<br/>
<a href="https://docs.microsoft.com/it-it/windows/win32/secauthz/ace-strings?redirectedfrom=MSDN">https://docs.microsoft.com/it-it/windows/win32/secauthz/ace-strings?redirectedfrom=MSDN</a><br/>
</i></b><br/>
<b>Ecco l'ACE per gli Amministratori built-in per i WMI Spaces:</b><br/>
A;CI;CCDCLCSWRPWPRCWD;;;SID<br/>
(Per ottenere i pieni permessi su un utente,<br/>
basta sostituire in SID il SID dell'utente che vogliamo!)<br/>
<br/>
<img src="1.png" /><br/>
<br/>
<img src="2.png" /><br/>
<br/>
<br/>
<img src="1 6.png" /><br/>
<br/>
Aggiungi l'utente:<br/>
<img src="2 4.png" /><br/>
<br/>
<img src="3.png" /><br/>
<br/>
<img src="4.png" /><br/>
<br/>
<img src="5.png" /><br/>
<br/>
<br/>
<br/>
Ora, per trovare il namespace del WMI:<br/>
<img src="1 3.png" width="950" height="191" /><br/>
<br/>
<img src="1 4.png" /><br/>
<br/>
<img src="1 5.png" /><br/>
<br/>
<img src="2 3.png" /><br/>
<br/>
<img src="3 2.png" /><br/>
<br/>
<img src="4 2.png" /><br/>
<br/>
<br/>
Infine, possiamo verificare col comando:<br/>
<img src="1 2.png" /><br/>
<hr/><hr/><br/>
E' possibile effettuare delle azioni utili, anche da linea di comando.<br/>
Questo permette ad utenti non-admin di accedere ad oggetti sicuri:<br/>
<br/>
<img src="1 8.png" /><br/>
<br/>
<img src="1 7.png" /><br/>
<br/>
<img src="1 9.png" /><br/>
<br/>
<hr/><hr/><br/>
Possiamo fare lo stesso di Set-RemoteWMI<br/>
con lo script <b>Set-RemotePSRemoting</b>:<br/>
<br/>
<img src="1 11.png" /><br/>
<br/>
<img src="1 10.png" /><br/>
<hr/><hr/><br/>
Possiamo effettuare le stesse operazioni ma modificando il registro di Windows:<br/>
<a href="https://github.com/HarmJ0y/DAMP">https://github.com/HarmJ0y/DAMP</a><br/>
<img src="1 12.png" /></body></html>